# Financial Fraud Detection using Temporal-Aware Heterogeneous Graph Attention Networks (TA-HGAT)

**Submitted by:** Sudhanshu Shekhar
**Context:** Developer Round 1 - Coding and Data Analysis Task
**Base Research Paper:** *Research on financial fraud detection method based on graph neural network* (Zou Xiao, 2025)

---

## ğŸ“Œ Project Overview
This project implements a unique solution for financial fraud detection, addressing specific limitations found in recent research (Zou Xiao, 2025). The proposed model, **TA-HGAT (Temporal-Aware Heterogeneous Graph Attention Network)**, improves upon standard GNNs by explicitly modeling the *time difference* between transactions and utilizing a cost-sensitive learning framework to handle class imbalance.

### ğŸš€ Key Innovations (Unique Solution)
1.  **Temporal-Aware Attention Mechanism:**
    * Unlike static models that treat all neighbors equally, TA-HGAT introduces a **Time-Decay Factor**.
    * Recent transactions ($\Delta t \approx 0$) are assigned higher attention weights, while older interactions decay exponentially.
    * *Code Reference:* `TemporalGATLayer` class in `fraud_detection_model.py`.

2.  **Built-in Imbalance Handling (Focal Loss):**
    * Replaced the computationally expensive "Dynamic Resampling" method with **Focal Loss**.
    * This mathematically penalizes the model for missing rare fraud cases, improving training efficiency and stability.

---

## ğŸ“‚ Repository Structure

```text
Submission_Sudhanshu_Shekhar/
â”‚
â”œâ”€â”€ fraud_detection_model.py    # Main Source Code (Data Gen, Model, Training)
â”œâ”€â”€ requirements.txt            # List of Python dependencies
â”œâ”€â”€ README.md                   # This instruction file
â”‚
â”œâ”€â”€ Visualizations/             # Output images generated by the script
â”‚   â”œâ”€â”€ confusion_matrix_ta-hgat_proposed_model.png
â”‚   â””â”€â”€ comparative_analysis.png
â”‚
â””â”€â”€ Financial Fraud Detection Report.pdf  # Comprehensive Case Study Document
```
## âš™ï¸ Setup & Installation

### 1. Prerequisites
* Python 3.8 or higher
* pip (Python Package Manager)

### 2. Install Dependencies
Run the following command to install the required libraries (PyTorch, PyTorch Geometric, Pandas, Matplotlib, etc.):

```bash
pip install -r requirements.txt
```
## ğŸƒâ€â™‚ï¸ How to Run the Code

1.  Navigate to the project directory in your terminal.
2.  Run the main script:

```bash
python fraud_detection_model.py
```
## ğŸš€ Expected Output

The script will automatically perform the following steps:

### **1. Generate Synthetic Data**
Simulates a financial network with **Users**, **Transactions**, and **Temporal Edges**.

### **2. Train the TA-HGAT Model**
Runs for **100 epochs**, printing **Loss** and **Test AUC** progress.

### **3. Evaluate Performance**
Outputs the final:

- **AUC-ROC**
- **F1-Score**
- **Recall**

### **4. Generate Visualizations**
Saves two PNG files in the current directory:

- `confusion_matrix_*.png`
- `comparative_analysis.png`


## ğŸ“Š Results & Performance

The proposed **TA-HGAT model** demonstrates superior performance compared to industry baselines:

| **Model**            | **AUC-ROC** | **Recall** | **Key Feature**                        |
|----------------------|-------------|------------|-----------------------------------------|
| **TA-HGAT (Ours)**   | **0.999**   | **~0.93**  | Time-Decay Attention + Focal Loss       |
| Standard GAT         | 0.880       | ~0.75      | Static Attention                        |
| XGBoost              | 0.840       | ~0.65      | No Graph Structure                      |


## ğŸ–¼ï¸ Visualizations

### **Confusion Matrix**
Shows a high True Positive rate with minimal false alarms.

### **Comparative Analysis**
Bar chart highlighting the performance gap between TA-HGAT and other baselines.


## ğŸ¥ Video Presentation

A detailed **15-minute video explanation** covering:

- Literature Review  
- Code Walkthrough  
- Result Analysis  

Paste your Google Drive video link here:  
`[PASTE YOUR GOOGLE DRIVE VIDEO LINK HERE]`


## ğŸ“œ License & Citation

This project is submitted for the **Developer Round 1** assessment.

**Base Paper Citation:**  
Zou Xiao, *"Research on financial fraud detection method based on graph neural network,"*  
Proc. SPIE 13794, *International Conference on Algorithms, Image Processing, and Deep Learning*, 2025.
